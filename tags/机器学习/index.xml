<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>æœºå™¨å­¦ä¹  on jiaotong</title>
    <link>https://jiaotong.me/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/</link>
    <description>Recent content in æœºå™¨å­¦ä¹  on jiaotong</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Sat, 22 Jul 2023 12:59:23 +0000</lastBuildDate>
    
	<atom:link href="https://jiaotong.me/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Pen</title>
      <link>https://jiaotong.me/post/pen/</link>
      <pubDate>Sat, 22 Jul 2023 12:59:23 +0000</pubDate>
      
      <guid>https://jiaotong.me/post/pen/</guid>
      <description>&lt;h1 id=&#34;è„‘petå›¾åƒåˆ†æå’Œç–¾ç—…é¢„æµ‹æŒ‘æˆ˜èµ›&#34;&gt;è„‘PETå›¾åƒåˆ†æå’Œç–¾ç—…é¢„æµ‹æŒ‘æˆ˜èµ›&lt;/h1&gt;
&lt;h2 id=&#34;æ¦‚è¿°&#34;&gt;æ¦‚è¿°&lt;/h2&gt;
&lt;p&gt;åŸºäºè„‘PETå›¾åƒçš„ç–¾ç—…é¢„æµ‹ï¼Œè®­ç»ƒé›†åˆ†ä¸ºNC(å¥åº·)å’ŒMCI(è½»åº¦è®¤çŸ¥éšœç¢)ã€‚é€šè¿‡å¯¹æ•°æ®é›†è¿›è¡Œå»ºæ¨¡ï¼Œå¯¹è½»åº¦è®¤çŸ¥éšœç¢è¿›è¡Œåˆ†æå’Œé¢„æµ‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ•°æ®é›†&#34;&gt;æ•°æ®é›†&lt;/h2&gt;
&lt;p&gt;æ•°æ®é›†ä¸­å›¾åƒåˆ†ä¸ºNCç»„å’ŒMCIç»„ï¼Œæ¯ç»„25ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬æ˜¯æ ¼å¼ä¸º&lt;code&gt;nii&lt;/code&gt;çš„å›¾åƒï¼Œè¿™ç§å›¾åƒæ˜¯åŒ»å­¦ä¸‰ç»´å›¾åƒï¼Œä¸ºå¤„ç†æ­¤ç±»å›¾åƒå¯ä½¿ç”¨pythonåº“&lt;code&gt;nibabel&lt;/code&gt;ï¼Œè¯¥åº“ä¸“é—¨ç”¨äºå¤„ç†åŒ»å­¦å›¾åƒã€‚&lt;/p&gt;
&lt;h2 id=&#34;é€»è¾‘å›å½’æ–¹æ³•--baseline&#34;&gt;é€»è¾‘å›å½’æ–¹æ³•  baseline&lt;/h2&gt;
&lt;p&gt;èµ›é¢˜æ•°æ®é›†è¾ƒå°ï¼Œå› æ­¤ä½¿ç”¨é€»è¾‘å›å½’çš„ä¼ ç»Ÿå›¾åƒåˆ†ç±»ç®—æ³•æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ•°æ®è¯»å–&#34;&gt;æ•°æ®è¯»å–&lt;/h3&gt;
&lt;p&gt;å¯¹äºniiæ ¼å¼çš„æ•°æ®ï¼Œä½¿ç”¨åº“&lt;code&gt;nibabel&lt;/code&gt;è¯»å–ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; nibabel &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; nib
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;img &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nib&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;load(path)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;nib.load()ä¼šè¿”å›ä¸€ä¸ªnumpyä¸­çš„arrayæ•°ç»„ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;img &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; img&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;dataobj[:, :, :, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# print(img.shape)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# éšæœºç­›é€‰å…¶ä¸­çš„10ä¸ªé€šé“æå–ç‰¹å¾&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;random_img &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; img[:, :, np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;random&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;choice(range(img&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;shape[&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;]), &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;)]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ç‰¹å¾æå–&#34;&gt;ç‰¹å¾æå–&lt;/h3&gt;
&lt;p&gt;æŸ¥çœ‹è¯¥æ•°ç»„çš„shapeä¸ºå››ç»´æ•°æ®ï¼Œæœ€åä¸€ç»´æ•°æ®ä»…ä¸º1ï¼Œæ•…å°†å…¶è½¬æ¢ä¸ºä¸‰ç»´æ•°æ®ï¼Œé€‰å–ç¬¬ä¸€ä¸ªé€šé“çš„æ•°æ®ï¼›åœ¨ä¸‰ä½å›¾åƒä¸­éšæœºé€‰å–10ä¸ªé€šé“çš„äºŒç»´å›¾åƒæå–æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;è§‚å¯Ÿå›¾åƒï¼Œé€‰å–ç‰¹å¾å€¼ï¼Œå–ç‰¹å¾8ä¸ªä½œä¸ºè®­ç»ƒä¸åˆ¤æ–­çš„æ ‡å‡†ï¼Œåˆ†åˆ«æ˜¯ï¼šéé›¶åƒç´ çš„æ•°é‡ï¼Œé›¶åƒç´ çš„æ•°é‡ï¼Œåƒç´ å¹³å‡å€¼ï¼Œåƒç´ æ ‡å‡†å·®ï¼Œåœ¨åˆ—æ–¹å‘ä¸Šå¹³å‡å€¼ä¸ä¸ºé›¶çš„åƒç´ æ•°é‡ï¼Œåœ¨è¡Œæ–¹å‘ä¸Šå¹³å‡å€¼ä¸ä¸ºé›¶çš„åƒç´ æ•°é‡ï¼Œåˆ—æ–¹å‘ä¸Šçš„åƒç´ æœ€å¤§å¹³å‡å€¼ï¼Œè¡Œæ–¹å‘ä¸Šçš„åƒç´ æœ€å¤§å¹³å‡å€¼ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;feat &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        (img_ &lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sum(),  &lt;span style=&#34;color:#75715e&#34;&gt;# éé›¶åƒç´ çš„æ•°é‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        (img_ &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sum(),  &lt;span style=&#34;color:#75715e&#34;&gt;# é›¶åƒç´ çš„æ•°é‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        img_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean(),  &lt;span style=&#34;color:#75715e&#34;&gt;# å¹³å‡å€¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        img_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;std(),  &lt;span style=&#34;color:#75715e&#34;&gt;# æ ‡å‡†å·®&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        len(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;where(img_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;))[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]),  &lt;span style=&#34;color:#75715e&#34;&gt;# åœ¨åˆ—æ–¹å‘ä¸Šå¹³å‡å€¼ä¸ä¸ºé›¶çš„æ•°é‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        len(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;where(img_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]),  &lt;span style=&#34;color:#75715e&#34;&gt;# åœ¨è¡Œæ–¹å‘ä¸Šå¹³å‡å€¼ä¸ä¸ºé›¶çš„æ•°é‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        img_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;max(),  &lt;span style=&#34;color:#75715e&#34;&gt;# åˆ—æ–¹å‘ä¸Šçš„æœ€å¤§å¹³å‡å€¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        img_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;max()  &lt;span style=&#34;color:#75715e&#34;&gt;# è¡Œæ–¹å‘ä¸Šçš„æœ€å¤§å¹³å‡å€¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¹‹åå¯¹äºæ¯ä¸ªæ•°æ®ï¼Œä¿å­˜å…¶ç‰¹å¾å’Œç±»åˆ«äºä¸€ä¸ªåˆ—è¡¨ä¸­ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ¨¡å‹è®­ç»ƒ&#34;&gt;æ¨¡å‹è®­ç»ƒ&lt;/h3&gt;
&lt;p&gt;å¯¹è®­ç»ƒé›†è¿›è¡Œ30æ¬¡ç‰¹å¾æå–ï¼Œæ¯æ¬¡æå–çš„ç‰¹å¾å’Œç±»åˆ«éƒ½æ·»åŠ åˆ°&lt;code&gt;train_feat&lt;/code&gt;ä¸­ï¼Œæ¯æ¬¡æå–æ¯ä¸ªå›¾ç‰‡çš„10ä¸ªé€šé“ï¼Œæ¯ä¸ªé€šé“8ä¸ªç‰¹å¾ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(&lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt;):  &lt;span style=&#34;color:#75715e&#34;&gt;# 30æ¬¡ç‰¹å¾æå–&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    print(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;æ­£åœ¨æå–ç¬¬&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;ä¸ªæ ·æœ¬çš„ç‰¹å¾&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;format(i))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; path &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; train_path:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        train_feat&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(extract_feature(path))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# å…¶ä¸­extract_feature(path)å‡½æ•°æå–å›¾ç‰‡ç‰¹å¾&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸æ­¤åŒæ—¶å¯¹æµ‹è¯•é›†åŒæ ·è¿›è¡Œç‰¹å¾æå–ï¼Œä»¥å¾…åç»­é¢„æµ‹ä¸­çš„ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;å»ºç«‹é€»è¾‘å›å½’æ¨¡å‹ï¼Œè¿™ç§å›å½’æ–¹å¼å¯¹çº¿æ€§å…³ç³»çš„æ‹Ÿåˆæ•ˆæœè¾ƒå¥½ï¼Œå°†ç‰¹å¾å’Œç±»åˆ«è¾“å…¥å…¶ä¸­è¿›è¡Œè®­ç»ƒã€‚é€»è¾‘å›å½’å¯ä»¥ç›´æ¥é€šè¿‡sklearnè¿›è¡Œè°ƒç”¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; sklearn.linear_model &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; LogisticRegression
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;m &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; LogisticRegression(max_iter&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1000&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;m&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fit(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;# [:, :-1] è¡¨ç¤ºå–æ‰€æœ‰è¡Œï¼Œå»æ‰æœ€åä¸€åˆ—&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;array(train_feat)[:, :&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;astype(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;float32),  &lt;span style=&#34;color:#75715e&#34;&gt;# ç‰¹å¾&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;array(train_feat)[:, &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]  &lt;span style=&#34;color:#75715e&#34;&gt;# ç±»åˆ«&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;é¢„æµ‹ç»“æœ&#34;&gt;é¢„æµ‹ç»“æœ&lt;/h3&gt;
&lt;p&gt;åœ¨é¢„æµ‹æ—¶ï¼Œå°†æµ‹è¯•é›†æå–çš„ç‰¹å¾è¾“å…¥è®­ç»ƒè¿‡çš„é€»è¾‘å›å½’æ¨¡å‹ä¸­ï¼Œå¾—åˆ°é¢„æµ‹ç»“æœã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;test_pred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; m&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;predict(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;array(test_feat)[:, :&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;astype(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;float32))
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å› ä¸ºæµ‹è¯•é›†ä¹Ÿæå–äº†å¤šæ¬¡ç‰¹å¾ï¼Œå› æ­¤å¯ä»¥å¾—åˆ°å¤šä¸ªé¢„æµ‹ç»“æœï¼Œæ­¤æ—¶é€šè¿‡åˆ¤æ–­å“ªç±»çš„é¢„æµ‹åœ¨ç»“æœä¸­å æ¯”è¾ƒé«˜è€Œé€‰æ‹©å“ªç±»ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;test_pred_label &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [Counter(x)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;most_common(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;][&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;] &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; x &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; test_pred]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€ç»ˆæ­£ç¡®ç‡åŸºæœ¬åªæœ‰50%ï¼Œå› æ­¤éœ€è¦å¯¹å…¶è¿›è¡Œæ”¹è¿›ã€‚ä¸€ç§æ”¹è¿›æ˜¯åœ¨è¯¥æ–¹æ³•çš„åŸºç¡€ä¸Šä¼˜åŒ–æ•°æ®ï¼Œæé«˜é‡‡æ ·é‡(å³å¯¹æ¯ä¸ªå›¾åƒé€‰å–å¤šä¸ªé€šé“æˆ–å¢åŠ ç‰¹å¾æå–çš„æ¬¡æ•°)ï¼›å¦å¤–ä¸€ç§æ–¹æ³•æ˜¯é‡‡ç”¨æ·±åº¦å­¦ä¹ çš„æ–¹æ³•è¿›è¡Œåˆ†ç±»ã€‚&lt;/p&gt;
&lt;h3 id=&#34;baselineæ”¹è¿›&#34;&gt;baselineæ”¹è¿›&lt;/h3&gt;
&lt;p&gt;ç”±äºå‘ç°æ•°æ®é›†çš„ä¸‰ç»´å›¾ç‰‡ä¸Šï¼Œé™¤äº†å¤§è„‘çš„penå›¾åƒé»‘æ¡†å æ¯”è¾ƒå¤§ï¼Œé»‘æ¡†å¯¹ç»“æœçš„å½±å“è¾ƒå¤§ï¼Œè¿™é‡Œæˆ‘æƒ³äº†ä¸€äº›æ–¹æ³•ï¼š&lt;/p&gt;
&lt;p&gt;éå†å›¾åƒï¼Œæ‰¾åˆ°â€å¤§è„‘â€œå‡ºç°çš„é˜ˆå€¼ï¼Œå°†å…¶è£å‰ªä½¿å¾—å…¶æ­£å¥½è¢«æ­£æ–¹å½¢æ¡†å›´ä½ï¼Œä½†å› ä¸ºæ•°æ®å¤§å°ä¸åŒï¼Œè¿™æ ·è£å‰ªå‡ºæ¥æœ€åå›¾åƒçš„å¤§å°ä¸åŒ&amp;hellip;æƒ³äº†å¾ˆå¤šæ–¹æ³•ï¼Œæœ€åä½¿ç”¨äº†éšæœºè£å‰ªæ–¹æ³•ï¼Œè§å›¾åƒä¸­â€å¤§è„‘â€œéƒ¨åˆ†å æ•´ä¸ªå›¾åƒçš„ä¸€åŠä»¥ä¸Šï¼Œè¿™é‡Œæˆ‘å°†å›¾åƒçš„éšæœºé€‰å‡º10ä¸ªé€šé“è¿›è¡Œäº†è£å‰ªï¼Œä½¿ç”¨é€»è¾‘å›å½’æ¨¡å‹è®­ç»ƒï¼Œæ­£ç¡®ç‡è¾¾åˆ°äº†æ¥è¿‘0.6.&lt;/p&gt;
&lt;p&gt;å†³ç­–æ ‘å›å½’æ¨¡å‹ï¼šé€»è¾‘å›å½’å¯¹äºçº¿æ€§å…³ç³»å»ºæ¨¡æ•ˆæœè¾ƒå¥½ï¼Œäºæ˜¯æˆ‘ä½¿ç”¨å†³ç­–æ ‘æ¨¡å‹ï¼Œè·‘å‡ºæ¥å±…ç„¶å…¨æ˜¯MCI emmmmmğŸ¤£ğŸ¤£ï¼Œå‹‡å¤ºé›¶åˆ†ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>èˆªç©ºå…¬å¸å®¢æˆ·ä»·å€¼åˆ†æ</title>
      <link>https://jiaotong.me/post/kmeans/</link>
      <pubDate>Fri, 26 May 2023 18:02:11 +0000</pubDate>
      
      <guid>https://jiaotong.me/post/kmeans/</guid>
      <description>&lt;h1 id=&#34;èˆªç©ºå…¬å¸å®¢æˆ·ä»·å€¼åˆ†æ&#34;&gt;èˆªç©ºå…¬å¸å®¢æˆ·ä»·å€¼åˆ†æ&lt;/h1&gt;
&lt;h2 id=&#34;åŸç†åˆ†æ&#34;&gt;åŸç†åˆ†æ&lt;/h2&gt;
&lt;p&gt;åœ¨å¸‚åœºç«äº‰ä¸Šï¼Œå¯¹äºèˆªç©ºå…¬å¸è€Œè¨€ï¼Œéœ€è¦èˆªç©ºå…¬å¸å¯¹å®¢æˆ·è¿›è¡Œç«äº‰ã€‚è¿™å°±éœ€è¦èˆªç©ºå…¬å¸å¯¹ç”¨æˆ·è¿›è¡Œåˆ†ç±»ï¼Œå¾—åˆ°ç”¨æˆ·çš„ç”¨æˆ·ä»·å€¼ï¼Œä»è€Œæœ‰é’ˆå¯¹æ€§åœ°å¯¹ç”¨æˆ·æŠ•æ”¾èµ„æºã€‚&lt;/p&gt;
&lt;h3 id=&#34;rfmæ¨¡å‹&#34;&gt;RFMæ¨¡å‹&lt;/h3&gt;
&lt;p&gt;RFMæ¨¡å‹æ˜¯åˆ©ç”¨é€šç”¨äº¤æ˜“ç¯èŠ‚ä¸­æœ€æ ¸å¿ƒçš„ä¸‰ä¸ªç»´åº¦â€”â€”æœ€è¿‘æ¶ˆè´¹(Recency)ã€æ¶ˆè´¹é¢‘ç‡(Frequency)ã€æ¶ˆè´¹é‡‘é¢(Monetary)ç»†åˆ†å®¢æˆ·ç¾¤ä½“ï¼Œä»è€Œåˆ†æä¸åŒç¾¤ä½“çš„å®¢æˆ·ä»·å€¼ã€‚&lt;/p&gt;
&lt;h3 id=&#34;lrfcmæ¨¡å‹&#34;&gt;LRFCMæ¨¡å‹&lt;/h3&gt;
&lt;p&gt;RPMæ¨¡å‹å¹¶ä¸é€‚åˆæ‰€æœ‰è¡Œä¸šï¼Œé‚£ä¹ˆå°±éœ€è¦åœ¨RFMæ¨¡å‹çš„åŸºç¡€ä¸Šæ·»åŠ æŒ‡æ ‡ä»¥æé«˜æ¨¡å‹æ›´é«˜çš„æ‹Ÿåˆåº¦ã€‚æ·»åŠ 2ä¸ªæŒ‡æ ‡ç”¨äºå®¢æˆ·åˆ†ç¾¤ä¸ä»·å€¼åˆ†æï¼Œå¾—åˆ°èˆªç©ºè¡Œä¸šçš„LRFMCæ¨¡å‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Lï¼šå…¥ä¼šæ—¶é—´è·è§‚æµ‹çª—å£ç»“æŸçš„æœˆæ•°(å¯èƒ½çš„æ´»è·ƒæ—¶é•¿) = è§‚æµ‹çª—å£ç»“æŸæ—¶é—´ - å…¥ä¼šæ—¶é—´ = LOAD_TIME - FFP_DATE&lt;/li&gt;
&lt;li&gt;Rï¼šå®¢æˆ·æœ€è¿‘ä¸€æ¬¡ä¹˜åå…¬å¸é£æœºè·è§‚æµ‹çª—å£ç»“æŸçš„æœˆæ•°(å½“å‰æ´»è·ƒçŠ¶æ€) = LAST_TO_END&lt;/li&gt;
&lt;li&gt;Fï¼šå®¢æˆ·åœ¨è§‚æµ‹çª—å£å†…ä¹˜åå…¬å¸é£æœºçš„æ¬¡æ•° = FLIGHT_COUNT&lt;/li&gt;
&lt;li&gt;Mï¼šå®¢æˆ·åœ¨è§‚æµ‹çª—å£å†…ç´¯è®¡çš„é£è¡Œé‡Œç¨‹(ä¾èµ–æ€§) = SEG_KM_SUM&lt;/li&gt;
&lt;li&gt;Cï¼šå®¢æˆ·åœ¨è§‚æµ‹çª—å£å†…æŠ˜æ‰£ç³»æ•°çš„å¹³å‡å€¼(å®¢æˆ·ä»·å€¼) = avg_discount&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;k-meansèšç±»ç®—æ³•&#34;&gt;K-Meansèšç±»ç®—æ³•&lt;/h3&gt;
&lt;p&gt;K-Meansèšç±»ç®—æ³•æ˜¯ä¸€ç§æ— ç›‘ç£å­¦ä¹ æ–¹æ³•ã€‚èšç±»ç®—æ³•èƒ½å¤Ÿæ‰¾åˆ°ä¸åŒæ•°æ®ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼Œå°†æ•°æ®é›†åˆ†å‰²æˆä¸åŒçš„ç±»æˆ–ç°‡ã€‚&lt;/p&gt;
&lt;p&gt;K-Meansèšç±»ç®—æ³•çš„ä¸»è¦æ­¥éª¤æ˜¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é¦–å…ˆè¦äº‹å…ˆç¡®å®šåˆ’åˆ†çš„ç°‡æ•°Kï¼Œå¹¶éšæœºç”Ÿæˆæ¯ä¸ªç°‡çš„ä¸­å¿ƒç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;éå†æ•°æ®é›†ä¸­çš„æ¯ä¸ªæ•°æ®ï¼Œè®¡ç®—å…¶åˆ°Kä¸ªç°‡ä¸­å¿ƒç‚¹çš„æ¬§å‡ é‡Œå¾—è·ç¦»å–æœ€å°è€…ï¼Œå°†è¯¥æ•°æ®åŠ å…¥è¯¥ä¸­å¿ƒç‚¹æ‰€ä»£è¡¨çš„ç°‡ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;å½“ç°‡ä¸­åŠ å…¥äº†æ•°æ®ï¼Œæ­¤æ—¶ä¾¿èƒ½å¤Ÿæ›´æ–°Kä¸ªç°‡çš„ä¸­å¿ƒä½ç½®ã€‚&lt;/li&gt;
&lt;li&gt;å½“æ›´æ–°å®Œæ¯•ä¸­å¿ƒä½ç½®ä¹‹åï¼Œé‡å¤æ­¥éª¤2.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¯¹äºç†è§£è¯¥ç®—æ³•çš„ä¸€ä¸ªå¯è§†åŒ–è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./photo/1.png&#34; alt=&#34;1&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./photo/2.png&#34; alt=&#34;1&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./photo/3.png&#34; alt=&#34;1&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./photo/4.png&#34; alt=&#34;1&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./photo/5.png&#34; alt=&#34;1&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¯¥è¿‡ç¨‹æºè‡ªç½‘ç«™ï¼šhttps://www.naftaliharris.com/blog/visualizing-k-means-clustering/&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°K-Meansç®—æ³•éœ€è¦æˆ‘ä»¬é¢„å…ˆè®¾å®šKå€¼ï¼Œå¯¹äºè¾ƒä¸ºå¤æ‚çš„æ•°æ®è¯¥ç®—æ³•è¡¨ç°å·®å¼ºäººæ„ï¼Œå¦‚å›¾&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./photo/6.png&#34; alt=&#34;1&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸”ä¸­å¿ƒç‚¹åˆå€¼çš„é€‰æ‹©ä¹Ÿä¼šå½±å“æœ€ç»ˆçš„ç»“æœï¼Œè¿™é‡Œæˆ‘ä»¬ä¼šè¿›è¡Œå¤šæ¬¡è®¡ç®—æ±‚å¹³å‡å€¼ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªæ ‡å‡†æ¥è¡¡é‡èšç±»ç»“æœçš„å¥½åä»¥åŠåœ¨ä¸èƒ½ç›´è§‚åˆ¤æ–­æ•°æ®çš„ç°‡æ•°Kæ—¶ï¼Œå¦‚ä½•é€‰æ‹©Kå€¼ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è‚˜éƒ¨æ³•&#34;&gt;è‚˜éƒ¨æ³•&lt;/h3&gt;
&lt;p&gt;æ ¹æ®è¯„ä»·æŒ‡æ ‡inertia_ï¼Œè¯¥æŒ‡æ ‡è¡¨ç¤ºæ¯ä¸ªæ ·æœ¬ç‚¹åˆ°å…¶æ‰€åœ¨ç°‡ä¸­å¿ƒçš„è·ç¦»ä¹‹å’Œã€‚inertia_å€¼è¶Šå°åˆ™è¡¨ç¤ºèšç±»æ•ˆæœè¶Šå¥½ã€‚ä½†å½“Kå€¼ä¸æ–­å¢å¤§æ—¶ï¼Œinertia_ä¹Ÿå¿…ç„¶å‡å°ï¼Œè¿™æ˜¯å› ä¸ºç°‡æ•°å¢å¤šï¼Œå¿…å°†ä¸æ–­ç»†åˆ†æ ·æœ¬ï¼Œæ ·æœ¬ç‚¹åˆ°ç°‡ä¸­å¿ƒçš„è·ç¦»ä¹‹å’Œå¿…ç„¶å‡å°ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥æ‰¾å¯»ä¸€ä¸ªæ‹ç‚¹ï¼Œåœ¨è¯¥ç‚¹ä¹‹å‰inertia_å‡å°å¾—è¾ƒå¿«ï¼Œåœ¨è¯¥ç‚¹ä¹‹åinertia_å‡å°å¾—è¾ƒæ…¢ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è½®å»“ç³»æ•°æ³•&#34;&gt;è½®å»“ç³»æ•°æ³•&lt;/h3&gt;
&lt;p&gt;è½®å»“ç³»æ•°silhouette_scoreï¼Œè¯¥æŒ‡æ ‡ç”¨äºè¡¨ç¤ºåŒä¸€ä¸ªèšç±»å†…éƒ¨çš„æ ·æœ¬å¯†é›†ï¼Œä¸åŒèšç±»ä¹‹é—´æ ·æœ¬ç–è¿œçš„ç¨‹åº¦ã€‚è½®å»“ç³»æ•°ç»“åˆäº†å†…èšåº¦å’Œåˆ†ç¦»åº¦ä¸¤ä¸ªå› ç´ ï¼Œå…¶å…¬å¼å¦‚ä¸‹ï¼š
$$
s(i)=\frac{b(i)-a(i)}{max(a(i),b(i))}
$$
å…¶ä¸­a(i)è¡¨ç¤ºæ ·æœ¬ç‚¹iåˆ°åŒç°‡å…¶ä»–æ ·æœ¬ç‚¹è·ç¦»çš„å¹³å‡å€¼ï¼Œb(i)è¡¨ç¤ºæ ·æœ¬ç‚¹iåˆ°å…¶ä»–ç°‡æ‰€æœ‰ç‚¹å¹³å‡è·ç¦»çš„æœ€å°å€¼ã€‚&lt;/p&gt;
&lt;p&gt;å–å€¼èŒƒå›´ä¸º[-1, 1]ï¼Œè¶Šé è¿‘1è¡¨ç¤ºèšç±»æ•ˆæœè¶Šå¥½ï¼Œæ¥è¿‘0ä»£è¡¨æ ·æœ¬iå¤„åœ¨ä¸¤ä¸ªç°‡çš„è¾¹ç•Œä¸Šï¼Œè¶Šæ¥è¿‘-1è¡¨ç¤ºæ ·æœ¬iåˆ†ç±»é”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªè¾ƒä¸ºå¤§çš„silhouette_scoreä¸‹çš„Kå€¼ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ•°æ®æ¸…æ´—&#34;&gt;æ•°æ®æ¸…æ´—&lt;/h2&gt;
&lt;p&gt;åœ¨è¿›è¡Œèšç±»ä¹‹å‰ï¼Œéœ€è¦å¯¹æ•°æ®è¿›è¡Œæ¸…æ´—ã€‚å¯¹äºä¸€äº›é‡è¦çš„çš„æ•°æ®ï¼Œéœ€è¦åˆ¤æ–­å…¶æ˜¯å¦æœ‰ç¼ºå¤±ï¼Œæœ‰ç¼ºå¤±ï¼Œå°†æ•°æ®èˆå¼ƒã€‚å†åˆ¤æ–­æ˜¯å¦æœ‰å¼‚å¸¸æ•°æ®ï¼Œå°†å¼‚å¸¸æ•°æ®åˆ é™¤åæ‰å¯ç”¨æ¥èšç±»è®­ç»ƒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# å»é™¤ç¥¨ä»·ä¸ºç©ºçš„è®°å½•&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;exp1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; airline_data[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;SUM_YR_1&amp;#34;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;notnull()  &lt;span style=&#34;color:#75715e&#34;&gt;# è¿”å›å¸ƒå°”å€¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;exp2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; airline_data[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;SUM_YR_2&amp;#34;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;notnull()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;exp &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; exp1 &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt; exp2  &lt;span style=&#34;color:#75715e&#34;&gt;# &amp;amp;æ˜¯é€»è¾‘ä¸è¿ç®—ç¬¦ï¼Œåˆå¹¶ç»“æœ&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;expçš„å½¢çŠ¶æ˜¯ï¼š&amp;#39;&lt;/span&gt;, exp&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;shape)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;airline_notnull &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; airline_data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;loc[exp, :]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# locæ˜¯åŸºäºè¡Œæ ‡ç­¾å’Œåˆ—æ ‡ç­¾ï¼ˆx_labelã€y_labelï¼‰è¿›è¡Œç´¢å¼•&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# loc[exp, :]è¡¨ç¤ºé€‰å–expä¸ºTrueçš„è¡Œï¼Œæ‰€æœ‰åˆ—&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;åˆ é™¤ç¼ºå¤±è®°å½•åæ•°æ®çš„å½¢çŠ¶ä¸ºï¼š&amp;#39;&lt;/span&gt;, airline_notnull&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;shape)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# åªä¿ç•™ç¥¨ä»·éé›¶çš„ï¼Œæˆ–è€…å¹³å‡æŠ˜æ‰£ç‡ä¸ä¸º0ä¸”æ€»é£è¡Œå…¬é‡Œæ•°å¤§äº0çš„è®°å½•ã€‚&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;index1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; airline_notnull[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;SUM_YR_1&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;index2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; airline_notnull[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;SUM_YR_2&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;index3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (airline_notnull[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;SEG_KM_SUM&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt; \
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;             (airline_notnull[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;avg_discount&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;airline &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; airline_notnull[(index1 &lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt; index2) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt; index3]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;åˆ é™¤å¼‚å¸¸è®°å½•åæ•°æ®çš„å½¢çŠ¶ä¸ºï¼š&amp;#39;&lt;/span&gt;, airline&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;shape)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;å»ºç«‹rfmå’Œlrfcmæ¨¡å‹æ•°æ®&#34;&gt;å»ºç«‹RFMå’ŒLRFCMæ¨¡å‹æ•°æ®&lt;/h2&gt;
&lt;p&gt;é€‰å–å’Œæ„é€ å¯¹åº”ç‰¹å¾çš„å˜é‡å¹¶åŠ ä»¥å‚¨å­˜æˆ&lt;code&gt;.npz&lt;/code&gt;æ ¼å¼&lt;/p&gt;
&lt;h2 id=&#34;k-meansç®—æ³•&#34;&gt;K-Meansç®—æ³•&lt;/h2&gt;
&lt;p&gt;åœ¨&lt;code&gt;scikit learn&lt;/code&gt;åº“ä¸­æä¾›äº†K-Meansèšç±»ç®—æ³•çš„ç›¸å…³æ–¹æ³•ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; sklearn.cluster &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; KMeans
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# n_clusterså‚æ•°è¡¨ç¤ºåˆ†æˆçš„ç°‡æ•°ï¼Œéœ€è¦ä¼ å…¥ï¼›n_initå‚æ•°è¡¨ç¤ºç”¨ä¸åŒçš„åˆå§‹åŒ–è´¨å¿ƒè¿è¡Œç®—æ³•çš„æ¬¡æ•°ï¼Œæœ€åæ ¹æ®inertia_ç¡®ç«‹æœ€å¥½çš„ç»“æœï¼›random_stateä¸ºéšæœºæ•°ç§å­&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;kmeans_model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; KMeans(n_clusters&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;k, n_init&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;, random_state&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;123&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;fit_kmeans &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; kmeans_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fit(airline_scale)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;ç¡®ç«‹kå€¼&#34;&gt;ç¡®ç«‹Kå€¼&lt;/h2&gt;
&lt;p&gt;é€šè¿‡è‚˜éƒ¨æ³•å’Œè½®å»“ç³»æ•°æ³•ç»˜åˆ¶å‡ºå¯¹åº”å›¾åƒï¼Œæ ¹æ®å›¾åƒç‰¹ç‚¹é€‰æ‹©è¾ƒä¸ºåˆé€‚çš„Kå€¼ã€‚è¿™é‡Œæˆ‘å°†è®¡ç®—Kå–[2,10)èšç±»çš„ç»“æœè¿›è¡Œæ¯”è¾ƒï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; sklearn.metrics &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; silhouette_score
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;K &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; range(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sse_result &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;silhouette_result &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; k &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; K:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    kmeans, s &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; K_means(k, method)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;# cdistè®¡ç®—æ¯ä¸ªæ ·æœ¬åˆ°èšç±»ä¸­å¿ƒçš„è·ç¦»ï¼Œå–æœ€å°å€¼å¹¶æ±‚å’Œï¼Œå†é™¤ä»¥æ ·æœ¬æ•°&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;# euclideanç”¨äºè®¡ç®—æ¬§å‡ é‡Œå¾—è·ç¦»&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;# sse_result.append(sum(np.min(cdist(s, kmeans.cluster_centers_, &amp;#39;euclidean&amp;#39;), axis=1)) / s.shape[0])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;# .inertia_èƒ½å¤Ÿç›´æ¥è®¡ç®—å‡ºsseçš„å€¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sse_result&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(kmeans&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;inertia_)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;# è½®å»“ç³»æ•°æ³•é€‰æ‹©kå€¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    silhouette_result&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(silhouette_score(s, kmeans&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;labels_, metric&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;euclidean&amp;#39;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;silhouette_score&lt;/code&gt;å¯ä»¥é€šè¿‡sklearnæä¾›çš„æ–¹æ³•è®¡ç®—å¾—å‡ºï¼Œä½†æ•°æ®è¾ƒå¤§ï¼Œå¾—åˆ°ç»“æœæ‰€éœ€æ—¶é—´è¾ƒé•¿ï¼Œå› æ­¤å°†ç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;savez(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;../tmp/sse_silhouette_result_&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; method &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;.npz&amp;#39;&lt;/span&gt;, sse_result, silhouette_result)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¹‹åå†è¯»å–æ–‡ä»¶å†…å®¹ç»˜åˆ¶SSE-Kå›¾å’Œsilhouette_score-Kå›¾ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åˆ¶å®šè¥é”€ç­–ç•¥&#34;&gt;åˆ¶å®šè¥é”€ç­–ç•¥&lt;/h2&gt;
&lt;p&gt;å¾—åˆ°é›·è¾¾å›¾å¦‚å›¾æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;./photo/leda.png&#34; alt=&#34;1&#34;&gt;&lt;/p&gt;
&lt;p&gt;å°†å®¢æˆ·åˆ†ä¸ºå››ç±»åˆ¶å›¾å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å®¢æˆ·ç¾¤&lt;/th&gt;
&lt;th&gt;ä¼šå‘˜æ—¶é•¿L&lt;/th&gt;
&lt;th&gt;æœ€è¿‘ä¹˜æœºR&lt;/th&gt;
&lt;th&gt;ä¹˜æœºæ¬¡æ•°F&lt;/th&gt;
&lt;th&gt;é£è¡Œé‡Œç¨‹M&lt;/th&gt;
&lt;th&gt;å¹³å‡æŠ˜æ‰£C&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;class_1&lt;/td&gt;
&lt;td&gt;â­â­&lt;/td&gt;
&lt;td&gt;â­&lt;/td&gt;
&lt;td&gt;â­&lt;/td&gt;
&lt;td&gt;â­&lt;/td&gt;
&lt;td&gt;â­â­â­â­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;class_2&lt;/td&gt;
&lt;td&gt;â­&lt;/td&gt;
&lt;td&gt;â­&lt;/td&gt;
&lt;td&gt;â­&lt;/td&gt;
&lt;td&gt;â­&lt;/td&gt;
&lt;td&gt;â­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;class_3&lt;/td&gt;
&lt;td&gt;â­&lt;/td&gt;
&lt;td&gt;â­â­â­&lt;/td&gt;
&lt;td&gt;â­&lt;/td&gt;
&lt;td&gt;â­&lt;/td&gt;
&lt;td&gt;â­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;class_4&lt;/td&gt;
&lt;td&gt;â­â­â­&lt;/td&gt;
&lt;td&gt;â­&lt;/td&gt;
&lt;td&gt;â­&lt;/td&gt;
&lt;td&gt;â­&lt;/td&gt;
&lt;td&gt;â­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;class_5&lt;/td&gt;
&lt;td&gt;â­â­&lt;/td&gt;
&lt;td&gt;â­&lt;/td&gt;
&lt;td&gt;â­â­â­&lt;/td&gt;
&lt;td&gt;â­â­â­&lt;/td&gt;
&lt;td&gt;â­â­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;class_6&lt;/td&gt;
&lt;td&gt;â­â­&lt;/td&gt;
&lt;td&gt;â­&lt;/td&gt;
&lt;td&gt;â­â­â­â­â­&lt;/td&gt;
&lt;td&gt;â­â­â­â­â­&lt;/td&gt;
&lt;td&gt;â­â­&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;class_1ï¼šè¯¥ç¾¤ä½“å…¥ä¼šæ—¶é—´è¾ƒé•¿äº«å—å¹³å‡æŠ˜æ‰£é«˜.&lt;/p&gt;
&lt;p&gt;class_2ï¼šè¯¥ç¾¤ä½“å…¥ä¼šæ—¶é—´çŸ­ï¼Œæœ€è¿‘ä¹˜æœºæ—¶é—´è·ä»Šè¾ƒçŸ­ï¼Œä¹˜æœºæ¬¡æ•°å°‘ï¼Œé£è¡Œé‡Œç¨‹çŸ­ï¼Œå¹³å‡æŠ˜æ‰£ä½ï¼Œç¾¤ä½“äººæ•°ä¹Ÿæœ€å¤§ï¼Œå±äºå¤§ä¼—å®¢æˆ·ã€‚éœ€è¦èˆªç©ºå…¬å¸åœ¨èµ„æºæœ‰ä½™ä¸”å…è®¸çš„æƒ…å†µä¸‹åŠ å¤§æŠ•å…¥ã€‚&lt;/p&gt;
&lt;p&gt;class_3ï¼šè¯¥æœ€è¿‘ä¹˜æœºæ—¶é—´æ®ä»Šè¾ƒé•¿ï¼Œä½†ä¹˜æœºæ¬¡æ•°å°‘ï¼Œæ­¤ç±»ç”¨æˆ·å æ¯”ä¹Ÿè¾ƒå¤§ï¼Œä¸å¤§ä¼—å®¢æˆ·ç±»ä¼¼ï¼Œä½†æœ€è¿‘å¹¶æ²¡æœ‰æ¶ˆè´¹ï¼Œå…¬å¸åº”è¯¥ç»™äºˆè¾ƒé«˜ä¼˜æƒ æŒ½ç•™å®¢æˆ·ã€‚&lt;/p&gt;
&lt;p&gt;class_4ï¼šè¯¥ç¾¤ä½“å…¥ä¼šæ—¶é—´é•¿ï¼Œæœ€è¿‘ä¹˜æœºæ—¶é—´è·ä»Šè¾ƒçŸ­ï¼Œä¹˜æœºæ¬¡æ•°å°‘ï¼Œé£è¡Œé‡Œç¨‹çŸ­ï¼Œæ­¤ç±»å®¢æˆ·å¯èƒ½å±äºå·²æµå¤±å®¢æˆ·ã€‚&lt;/p&gt;
&lt;p&gt;class_5ï¼šè¯¥ç¾¤ä½“å…¥ä¼šæ—¶é—´è¾ƒé•¿ï¼Œæœ€è¿‘ä¹˜æœºæ—¶é—´è·ä»Šè¾ƒçŸ­ï¼Œä¹˜æœºæ¬¡æ•°è¾ƒå¤šï¼Œä½†æŠ˜æ‰£è¾ƒä½ï¼Œæ­¤ç±»ç”¨æˆ·æœ‰å¾ˆå¤§å‘å±•æ½œåŠ›ï¼Œèˆªç©ºå…¬å¸åº”è¯¥ç»™äºˆè¾ƒå¤§èµ„æºå€¾æ–œï¼Œæé«˜ç”¨æˆ·ç²˜æ€§ã€‚&lt;/p&gt;
&lt;p&gt;class_6ï¼šè¯¥ç¾¤ä½“å…¥ä¼šæ—¶é—´è¾ƒé•¿ï¼Œæœ€è¿‘ä¹˜æœºæ—¶é—´è·ä»Šè¾ƒçŸ­ï¼Œä¹˜æœºæ¬¡æ•°å¤šï¼Œé£è¡Œé‡Œç¨‹é•¿ï¼Œä½†æŠ˜æ‰£è¾ƒä½ï¼Œæ­¤ç±»ç”¨æˆ·æ¶ˆè´¹é¢‘ç¹ï¼Œèˆªç©ºå…¬å¸ä¿æŒè¿™ç±»ç”¨æˆ·ï¼Œæé«˜ç”¨æˆ·ç²˜æ€§ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“ä»£ç å¯è§åç»­æ›´æ–°&amp;hellip;&amp;hellip;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>